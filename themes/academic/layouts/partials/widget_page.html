{{ partial "header.html" . }}
{{ partial "navbar.html" . }}

<!-- Flag for jQuery -->
<span id="homepage" style="display: none"></span>

{{ if .IsHome }}
  {{ .Scratch.Set "section" "home" }}
{{ else }}
  {{ .Scratch.Set "section" .Section }}
{{ end }}
{{ $section := .Scratch.Get "section" }}

<!-- Widgets -->
{{ $pages := slice }}
{{ if .IsHome }}
  {{ $sectionPage := .Site.GetPage "section" "home" }}
  {{ if $sectionPage }}
    {{ $pages = $sectionPage.RegularPages }}
  {{ end }}
  {{ if not $pages }}
    {{ $pages = where .Site.RegularPages "Section" "home" }}
  {{ end }}
{{ else }}
  {{ $pages = .Pages }}
{{ end }}
{{ $activePages := where $pages ".Params.active" "!=" false }}
{{ range $index, $page := sort $activePages ".Params.weight" }}
  {{ $params := dict "root" $ "page" $page }}
  {{ $widget := printf "widgets/%s.html" ( or $page.Params.widget "custom" ) }}
  {{ if in (slice "hero" "hero_carousel") $page.Params.widget }}
    {{ partial $widget $params }}
  {{ else }}
  <section id="{{ if $page.File }}{{ $page.File.TranslationBaseName }}{{ else }}{{ $page.Title | urlize }}{{ end }}" class="home-section">
    <div class="container">
      {{ partial $widget $params }}
    </div>
  </section>
  {{ end }}
{{ end }}

<!-- Page Footer -->
{{ partial "footer_container.html" . }}
{{ partial "footer.html" . }}
